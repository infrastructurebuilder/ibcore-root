<model xmlns="http://codehaus-plexus.github.io/MODELLO/1.8.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://codehaus-plexus.github.io/MODELLO/1.8.0 http://codehaus-plexus.github.io/modello/xsd/modello-1.8.0.xsd"
  java.suppressAllWarnings="false"
  xml.namespace="https://resources.infrastructurebuilder.org/IBDataSet/${apiVersion}"
  xml.schemaLocation="https://resources.infrastructurebuilder.org/xsd/IBDataSet-${apiVersion}"
  xsd.namespace="https://resources.infrastructurebuilder.org/IBDataSet/${apiVersion}"
  xsd.targetNamespace="https://resources.infrastructurebuilder.org/IBDataSet/${apiVersion}">
  <id>datasource</id>
  <name>IBDataSourceModel</name> <!--  Must be a single (no spaces, no dashes, no periods) identifier in order to create reader/writer -->
  <description>Mechanism to read config for an IBDataSource</description>

  <defaults>
    <default>
      <key>package</key>
      <value>${project.groupId}.model</value>
    </default>
  </defaults>
  <classes>
  <!-- MODEL -->
    <class rootElement="true" java.clone.hook="cloneHook">
      <name>DataSet</name>
      <description>
        <![CDATA[
        The <code>&lt;dataSet&gt;</code> element is the root of the configuration.
        ]]>
      </description>
      <version>1.0.0+</version>
      <interfaces>
        <interface>
          <![CDATA[org.infrastructurebuilder.data.IBDataSetIdentifier]]>
        </interface>
        <interface>
          <![CDATA[java.lang.Comparable<org.infrastructurebuilder.data.IBDataSetIdentifier>]]>
        </interface>
      </interfaces>
      <fields>

        <!-- ====================================================================== -->
        <!-- Deployment Version                                                          -->
        <!-- ====================================================================== -->
        <field>
          <name>modelVersion</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>Declares to which version of project descriptor this configuration conforms.</description>
          <type>String</type>
        </field>

        <field>
          <name>uuid</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>UUID identifier of the dataset.</description>
          <type>String</type>
        </field>
        <field>
          <name>name</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>The full name of the dataset.</description>
          <type>String</type>
        </field>
        <field>
          <name>description</name>
          <version>1.0.0+</version>
          <description>A detailed description of the dataset</description>
          <type>String</type>
        </field>
        <field>
          <name>creationDate</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>URL of the source of this stream, if available</description>
          <type>Date</type>
        </field>
        <field>
          <name>streams</name>
          <version>1.0.0+</version>
          <required>false</required>
          <description>Instances of DataStreams</description>
          <association>
            <type>DataStream</type>
            <multiplicity>*</multiplicity>
          </association>
        </field>
        <field>
          <name>_metadata</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>Additional metadata</description>
          <type>DOM</type>
        </field>
      </fields>
      <codeSegments>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
            //
            // Comparator Work
            //
  private static java.util.Comparator<org.infrastructurebuilder.data.IBDataSetIdentifier> IBDataSetIdentifierComparator = java.util.Comparator
      //  Check UUID
      .comparing(org.infrastructurebuilder.data.IBDataSetIdentifier::getId, org.infrastructurebuilder.util.IBUtils.nullSafeUUIDComparator)
      // Check Date
      .thenComparing(org.infrastructurebuilder.data.IBDataSetIdentifier::getCreationDate, org.infrastructurebuilder.util.IBUtils.nullSafeDateComparator);

  @Override
  public int compareTo(org.infrastructurebuilder.data.IBDataSetIdentifier that) {
    return IBDataSetIdentifierComparator.compare(this, that);
  }
            ]]>
          </code>
        </codeSegment>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
            //
            // ID mapper Work
            //
  @Override
  public java.util.UUID getId() {
     return org.infrastructurebuilder.data.IBDataException.cet.withReturningTranslation(() -> java.util.UUID.fromString(getUuid()));
  }            ]]>
          </code>
        </codeSegment>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
  @Override
  public org.w3c.dom.Document getMetadata() {
    return org.infrastructurebuilder.data.IBMetadataUtils.fromXpp3Dom.apply((org.codehaus.plexus.util.xml.Xpp3Dom) get_metadata());
  }

  ]]>
          </code>
        </codeSegment>
      </codeSegments>

    </class>
    <class java.clone="deep" xml.tagName="instance">
      <name>DataStream</name>
      <version>1.0.0+</version>
      <interfaces>
        <interface>
          <![CDATA[org.infrastructurebuilder.data.IBDataStreamIdentifier]]>
        </interface>
        <interface>
          <![CDATA[java.lang.Comparable<org.infrastructurebuilder.data.IBDataStreamIdentifier>]]>
        </interface>
      </interfaces>
      <description>
        <![CDATA[
        The <code>&lt;instance&gt;</code> element contains information about a configured instance of ArtifactServices.
        ]]>
      </description>
      <fields>
        <field>
          <name>uuid</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>UUID identifier of the datastream, which is the UUID of the bytes of the checksum of the data.</description>
          <type>String</type>
        </field>
        <field>
          <name>name</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>The full name of the datastream.</description>
          <type>String</type>
        </field>
        <field>
          <name>description</name>
          <version>1.0.0+</version>
          <description>A detailed description of the datastream</description>
          <type>String</type>
        </field>
        <field>
          <name>mimeType</name>
          <version>1.0.0+</version>
          <description>Stringified version of a MIME type for the datastream</description>
          <required>true</required>
          <defaultValue>application/octet-stream</defaultValue>
          <type>String</type>
        </field>
        <field>
          <name>creationDate</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>URL of the source of this stream, if available</description>
          <type>Date</type>
        </field>
        <field>
          <name>sourceURL</name>
          <version>1.0.0+</version>
          <required>false</required>
          <description>URL of the source of this stream, if available</description>
          <type>String</type>
        </field>
        <field>
          <name>sha512</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>Sha-512 Checksum  of the source of this stream</description>
          <type>String</type>
        </field>
        <field>
          <name>_metadata</name>
          <version>1.0.0+</version>
          <required>true</required>
          <description>Additional metadata</description>
          <type>DOM</type>
        </field>
      </fields>
      <codeSegments>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[


            ]]>
          </code>
        </codeSegment>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
            //
            // Comparator Work
            //
  private static java.util.Comparator<org.infrastructurebuilder.data.IBDataStreamIdentifier> ibDataStreamComparator = java.util.Comparator
      //  Check UUID
      .comparing(org.infrastructurebuilder.data.IBDataStreamIdentifier::getId, org.infrastructurebuilder.util.IBUtils.nullSafeUUIDComparator)
      // Check Date
      .thenComparing(org.infrastructurebuilder.data.IBDataStreamIdentifier::getCreationDate, org.infrastructurebuilder.util.IBUtils.nullSafeDateComparator);

  @Override
  public int compareTo(org.infrastructurebuilder.data.IBDataStreamIdentifier that) {
    return ibDataStreamComparator.compare(this, that);
  }
            ]]>
          </code>
        </codeSegment>

        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
            //
            // ID mapper Work
            //
  @Override
  public java.util.UUID getId() {
     return org.infrastructurebuilder.data.IBDataException.cet.withReturningTranslation(() -> java.util.UUID.fromString(getUuid()));
  }            ]]>
          </code>
        </codeSegment>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
            // Typed source url access
  @Override
  public java.util.Optional<java.net.URL> getURL() {
    return java.util.Optional.ofNullable(getSourceURL()).map(u -> org.infrastructurebuilder.data.IBDataException.cet.withReturningTranslation(() -> new java.net.URL(u)));
  }
  ]]>
          </code>
        </codeSegment>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
  @Override
  public org.w3c.dom.Document getMetadata() {
    return org.infrastructurebuilder.data.IBMetadataUtils.fromXpp3Dom.apply((org.codehaus.plexus.util.xml.Xpp3Dom) get_metadata());
  }

  ]]>
          </code>
        </codeSegment>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
            // Checksum
  @Override
  public org.infrastructurebuilder.util.artifacts.Checksum getChecksum() {
    return new org.infrastructurebuilder.util.artifacts.Checksum(getSha512());
  }
  ]]>
          </code>
        </codeSegment>
      </codeSegments>

    </class>
    <class locationTracker="locations" java.clone="shallow">
      <name>DataSetInputLocation</name>
      <version>1.0.0+</version>
      <fields>
        <!-- line, column and source fields are auto-generated by Modello -->
      </fields>
      <codeSegments>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[

    @Override
    public String toString()
    {
        return getLineNumber() + " : " + getColumnNumber() + ", " + getSource();
    }
            ]]>
          </code>
        </codeSegment>
      </codeSegments>
    </class>
    <class sourceTracker="source" java.clone="shallow">
      <name>DataSetInputSource</name>
      <version>1.0.0+</version>
      <fields>
        <field>
          <name>modelId</name>
          <version>1.0.0+</version>
          <type>String</type>
          <description>
            <![CDATA[
            The identifier of the deployment model in the format {@code <groupId>:<artifactId>:<version>}.
            ]]>
          </description>
        </field>
        <field>
          <name>location</name>
          <version>1.0.0+</version>
          <type>String</type>
          <description>
            <![CDATA[
            The path/URL of the deployment model or {@code null} if unknown.
            ]]>
          </description>
        </field>
      </fields>
      <codeSegments>
        <codeSegment>
          <version>1.0.0+</version>
          <code>
            <![CDATA[
    @Override
    public String toString()
    {
        return getModelId() + " " + getLocation();
    }
            ]]>
          </code>
        </codeSegment>
      </codeSegments>
    </class>
  </classes>
</model>